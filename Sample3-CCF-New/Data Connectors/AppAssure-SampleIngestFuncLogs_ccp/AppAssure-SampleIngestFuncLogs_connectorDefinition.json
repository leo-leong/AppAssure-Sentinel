{
  "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
  "apiVersion": "2022-09-01-preview",
  "name": "AppAssure-SampleIngestFuncLogsConnectorDefinition",
  "location": "{{location}}",
  "kind": "Customizable",
  "properties": {
    "connectorUiConfig": {
      "id": "AppAssure-SampleIngestFuncLogsConnectorDefinition",
      "title": "App Assure CCF Sample connector",
      "publisher": "AppAssure-Sample",
      "descriptionMarkdown": "The [App Assure CCF Sample](https://AppAssure.com/) data connector provides the capability to ingest App Assure CCF Sample events.",
      "graphQueriesTableName": "AppAssure-SampleIngestFuncLogs_CL",
      "graphQueries": [
        {
          "metricName": "Total events received",
          "legend": "App Assure CCF Sample events",
          "baseQuery": "AppAssure-SampleIngestFuncLogs_CL"
        }
      ],
      "sampleQueries": [
        {
          "description": "Get a sample of App Assure CCF Sample Event logs",
          "query": "AppAssure-SampleIngestFuncLogs_CL\n| take 10"
        }
      ],
      "dataTypes": [
        {
          "name": "AppAssure-SampleIngestFuncLogs_CL",
          "lastDataReceivedQuery": "AppAssure-SampleIngestFuncLogs_CL\n|summarize Time = max  (TimeGenerated)\n|where isnotempty(Time)"
        }
      ],
      "connectivityCriteria": [
        {
          "type": "HasDataConnectors",
          "value": null
        }
      ],
      "availability": {
        "isPreview": false
      },
      "permissions": {
        "resourceProvider": [
          {
            "provider": "Microsoft.OperationalInsights/workspaces",
            "permissionsDisplayText": "Read and Write permissions are required.",
            "providerDisplayName": "Workspace",
            "scope": "Workspace",
            "requiredPermissions": {
              "write": true,
              "read": true,
              "delete": true
            }
          }
        ],
        "customs": [
          {
            "name": "App Assure CCF Sample API access",
            "description": "Access to the App Assure CCF Sample API through a AppAssure Token is required."
          }
        ]
      },
      "instructionSteps": [
        {
        "description": "Provide your Identity Provider URL e.g. 'https://login.microsoftonline.com/<Directory ID>/oauth2/v2.0/token' and the token to access the API.",
          "instructions": [
            {
              "type": "Textbox",
              "parameters": {
                "label": "Identity Provider URL",
                "placeholder": "Identity Provider URL",
                "type": "text",
                "name": "IdentityProviderURL",
                "validations": {
                  "required": true
                }
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Identity Provider Token",
                "placeholder": "Identity Provider Token",
                "type": "password",
                "name": "IdentityProviderToken",
                "validations": {
                  "required": true
                }
              }
            },
            {
              "parameters": {
                "label": "toggle",
                "name": "toggle"
              },
              "type": "ConnectionToggleButton"
            }
          ],
          "title": "Connect to App Assure CCF Sample API to start collecting App Assure CCF Sample events and affected Objects in Microsoft Sentinel"
        }
      ]
    }
  }
}

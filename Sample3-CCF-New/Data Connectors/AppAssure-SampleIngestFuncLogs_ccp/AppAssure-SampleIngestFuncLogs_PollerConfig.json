[
  {
    "name": "AA_Sample2_IngestFuncTable",
    "apiVersion": "2025-09-01",
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "location": "{{location}}",
    "kind": "RestApiPoller",
    "properties": {
      "connectorDefinitionName": "AppAssure-SampleIngestFuncLogsConnectorDefinition",
      "dcrConfig": {
        "dataCollectionEndpoint": "{{dataCollectionEndpoint}}",
        "dataCollectionRuleImmutableId": "{{dataCollectionRuleImmutableId}}",
        "streamName": "Custom-AA_Sample2_IngestFuncTable_CL"
      },
      "dataType": "AA_Sample2_IngestFuncTable_CL",
      "auth": {
        "type": "JwtToken",
        "UserToken": "{{AppAssureToken}}",
        "UserTokenPrepend": "",
        "TokenEndpoint": "https://{{IdentityProviderURL}}/token",
        "TokenEndpointHttpMethod": "GET",
        "NoAccessTokenPrepend": true,
        "JwtTokenJsonPath": "$.systemToken"
      },
      "request": {
        "apiEndpoint": "https://{{AppAssureServiceEndpointURL}}/events",
        "rateLimitQPS": 5,
        "queryWindowInMin": 5,
        "httpMethod": "GET",
        "retryCount": 3,
        "timeoutInSeconds": 20,
        "headers": {
          "Accept": "application/json",
          "User-Agent": "AppAssure-MSFT-Sentinel-CCF-Connector (events)"
        }
      },
      "response": {
        "eventsJsonPaths": [
          "$"
        ],
        "format": "json"
      },
      "paging": {
        "pagingType": "Offset",
        "PageSize": 50,
        "PageSizeParameterName": "limit",
        "OffsetParaName": "offset"
      }
    }
  }
]
